{"id":"source-15l","title":"MST internal mapping function FUN_00e43182","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T20:38:43.668253-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:43.668253-08:00"}
{"id":"source-573","title":"MST remaining unmap variants (UNMAP_ALL, etc)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-13T20:38:50.096915-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:50.096915-08:00"}
{"id":"source-7vz","title":"MST wire and page management (mst_$unwire_*)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-13T20:38:50.181276-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:50.181276-08:00"}
{"id":"source-a97","title":"Add bounds checking to TERM_$STATUS_CONVERT","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-12T10:35:28.559937-08:00","created_by":"toshok","updated_at":"2026-01-12T10:35:28.559937-08:00"}
{"id":"source-bl7","title":"Implement PROC1_$ (Process Management) module","description":"Implement the PROC1_$ process management API with 50+ functions.\n\n## Functions identified:\n### Process lifecycle:\n- PROC1_$CREATE_P, PROC1_$BIND, PROC1_$UNBIND\n- PROC1_$SUSPEND, PROC1_$SUSPENDP, PROC1_$RESUME, PROC1_$TRY_TO_SUSPEND\n\n### Scheduling/Ready list:\n- PROC1_$DISPATCH, PROC1_$DISPATCH_INT, PROC1_$DISPATCH_INT2, PROC1_$DISPATCH_INT3\n- PROC1_$ADD_READY, PROC1_$REMOVE_READY, PROC1_$REORDER_READY\n- proc1_$remove_from_ready_list, proc1_$insert_into_ready_list, proc1_$reorder_if_needed\n\n### Locking:\n- PROC1_$SET_LOCK, PROC1_$CLR_LOCK, PROC1_$TST_LOCK, PROC1_$GET_LOCKS\n\n### Atomic operations:\n- PROC1_$BEGIN_ATOMIC_OP, PROC1_$END_ATOMIC_OP\n- PROC1_$INHIBIT_BEGIN, PROC1_$INHIBIT_END, PROC1_$INHIBIT_CHECK\n\n### Event count integration:\n- PROC1_$EC_WAITN\n\n### CPU/Load tracking:\n- PROC1_$GET_CPUT, PROC1_$GET_CPUT8, PROC1_$GET_CPU_USAGE, PROC1_$GET_ANY_CPUT, PROC1_$GET_ANY_CPU_USAGE\n- PROC1_$GET_LOADAV, PROC1_$LOADAV_CALLBACK, PROC1_$INIT_LOADAV\n\n### Other:\n- PROC1_$INIT, PROC1_$SET_ASID, PROC1_$SET_PRIORITY, PROC1_$SET_TYPE, PROC1_$GET_TYPE\n- PROC1_$VT_INT, PROC1_$SET_VT, PROC1_$SET_TS, PROC1_$TS_END_CALLBACK\n- PROC1_$ALLOC_STACK, PROC1_$FREE_STACK, PROC1_$GET_INFO, PROC1_$GET_LIST, PROC1_$GET_USP\n\n## PCB structure discovered:\n- 0x00: nextp, 0x04: prevp (ready list links)\n- 0x08-0x34: saved D2-D7, A2-A6, A7 registers\n- 0x38: saved USP\n- 0x3c: wait_start\n- 0x40: resource_locks_held (priority/lock bitmask)\n- 0x44: mypid, 0x46: asid\n- 0x48: vtimer, 0x4c-0x50: cpu_total/usage\n- 0x52: state, 0x54-0x55: pri_min/flags\n\n## Key globals:\n- PROC1_$CURRENT_PCB: 0xe1eac8\n- PROC1_$CURRENT: 0xe20608\n- PROC1_$READY_PCB: PC-relative\n- PROC1_$ATOMIC_OP_DEPTH: 0xe2060e\n- PCBS table: 0xe1eacc\n\n## Assembly patterns:\n- ori #0x700,SR / andi #-0x701,SR for interrupt disable/enable\n- movem.l for register save/restore in context switch\n- USP manipulation for user/supervisor stack handling","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-13T12:06:10.257198-08:00","created_by":"toshok","updated_at":"2026-01-14T10:31:21.245915-08:00","closed_at":"2026-01-14T10:31:21.245915-08:00","close_reason":"Implemented all PROC1_$ functions: 44 C source files and 3 assembly files for process management module including lifecycle, scheduling, locks, timers, CPU tracking, and dispatcher"}
{"id":"source-c0n","title":"Replace DTTE #define offsets with properly padded struct","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T14:43:56.802285-08:00","created_by":"toshok","updated_at":"2026-01-12T15:32:06.396403-08:00","closed_at":"2026-01-12T15:32:06.396403-08:00","close_reason":"Replaced DTTE #defines with properly padded dtte_t struct with named fields. Updated all term/*.c files to use struct access."}
{"id":"source-e7v","title":"PROC2_$ API Implementation","description":"Implementation of PROC2_$ high-level process management API. This module provides:\n- Process creation, forking, and deletion\n- Process naming and identification (UIDs, UPIDs)\n- Signal handling (BSD-style signals)\n- Process groups\n- Process information queries\n- Debug support\n\n64 functions identified. Structure analysis shows:\n- Process info table at 0xEA551C (228 bytes per entry)\n- Mapping table at 0xEA93D2 (PROC1 PID to PROC2 index)\n- Lock ID 4 for PROC2 operations\n\nCurrent progress: Header with 64 function declarations, 5 implementations","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-13T13:09:42.396454-08:00","created_by":"toshok","updated_at":"2026-01-13T20:26:23.432996-08:00","closed_at":"2026-01-13T20:26:23.432996-08:00","close_reason":"All 69 public PROC2 functions implemented plus 4 internal functions. Module complete."}
{"id":"source-f2l","title":"MST_$FORK - fork support for MST","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T20:38:43.585146-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:43.585146-08:00"}
{"id":"source-fzg","title":"Identify and type all DAT_* unknown data in term/ directory","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T14:43:56.729649-08:00","created_by":"toshok","updated_at":"2026-01-12T14:43:56.729649-08:00"}
{"id":"source-ga3","title":"Clean up extern declarations in all subsystems","description":"Remove all `extern` declarations from .c files and move them to proper header files.\n\n## Guidelines:\n- Public header: types/functions needed by OTHER subsystems\n- Internal header: helpers/types used ONLY within the subsystem\n- If a needed header doesn't exist, create it with just the required prototypes\n- **Symbols ending in _$UID (e.g., LV_LABEL_$UID) should go in uid/uid.h**\n\n## Subsystems status:\n- [x] arch/ (empty - no files)\n- [x] ast/ (completed)\n- [x] base/ (no .c files)\n- [x] cal/ (completed - 4 files updated)\n- [x] disk/ (completed - 18 files updated)\n- [x] ec/ (completed - created ec_internal.h)\n- [ ] flp/ (~75 externs - floppy driver data)\n- [x] math/ (already clean)\n- [x] misc/ (completed - 1 file updated)\n- [x] ml/ (completed - 3 files updated)\n- [x] mmap/ (completed - created mmap_internal.h)\n- [x] mmu/ (completed - created mmu_internal.h)\n- [x] mst/ (completed - created mst_internal.h)\n- [ ] os/ (152 externs in 4 files - mostly init.c/shutdown.c)\n- [x] osinfo/ (completed - 39 externs cleaned)\n- [x] pmap/ (completed - created pmap_internal.h)\n- [x] proc1/ (completed - created proc1_internal.h)\n- [ ] proc2/ (116 externs in 36 files)\n- [x] tape/ (already clean)\n- [ ] term/ (84 externs in 14 files)\n- [x] time/ (completed)\n- [x] tty/ (completed - created tty_internal.h)\n- [x] uid/ (already clean)\n- [x] win/ (completed - 1 file updated)\n\n## Headers created:\n- di/di.h, fim/fim.h, timer/timer.h\n- time/time_internal.h, ast/ast_internal.h\n- acl/acl.h, vtoc/vtoc.h, netbuf/netbuf.h\n- network/network.h, rem_file/rem_file.h\n- dxm/dxm.h, bat/bat.h, route/route.h, area/area.h, anon/anon.h\n- dbuf/dbuf.h, wp/wp.h, cache/cache.h\n- disk/disk_internal.h\n- kbd/kbd.h, prom/prom.h, ml/ml_internal.h\n- ec/ec_internal.h, mmap/mmap_internal.h\n- mmu/mmu_internal.h, mst/mst_internal.h\n- proc1/proc1_internal.h, tty/tty_internal.h\n- pmap/pmap_internal.h, smd/smd.h, dtty/dtty.h","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T14:44:54.451337-08:00","created_by":"toshok","updated_at":"2026-01-14T18:49:31.244931-08:00","closed_at":"2026-01-14T18:49:31.244931-08:00","close_reason":"Completed cleanup of extern declarations in all 8 remaining subsystems: proc1/, tty/, osinfo/, pmap/, term/, flp/, proc2/, os/. Created internal headers for each subsystem with proper declarations."}
{"id":"source-k7f","title":"Continue PROC2_$ module implementation","description":"Continue implementing the PROC2_$ high-level process management module.\n\n## Progress\n- **Implemented**: ~65 of 76 functions\n- **Remaining**: ~11 functions\n\n## Recently Implemented\n\n### Debug Support (DONE)\nDEBUG, OVERRIDE_DEBUG, UNDEBUG\n\n### Process Information (DONE)\nGET_EC, GET_CR_REC, GET_REGS, INFO, GET_INFO, BUILD_INFO_INTERNAL\n\n### Process Groups (DONE)\nSET_PGROUP, PGROUP_INFO, UID_TO_PGROUP_INDEX\n\n### Process Creation/Deletion - Simple (DONE)\nCOMPLETE_FORK, STARTUP, DELETE, SET_VALID\n\n## Remaining Functions by Category\n\n### Process Creation/Deletion (Complex)\n- INIT (~1210 bytes), CREATE (~1250 bytes), FORK (~1814 bytes)\n- COMPLETE_VFORK (~552 bytes)\n\n### Signal Handling (Internal)\n- DELIVER_SIGNAL_INTERNAL, DELIVER_PENDING_INTERNAL\n- DELIVER_PENDING, SIGRETURN, LOG_SIGNAL_EVENT\n\n## Notes\n- All code in proc2/ directory\n- Header file: proc2/proc2.h\n- Many functions share patterns: ML_$LOCK(4), FIM_$CLEANUP, entry lookup","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T16:42:26.528796-08:00","created_by":"toshok","updated_at":"2026-01-13T20:26:23.435061-08:00","closed_at":"2026-01-13T20:26:23.435061-08:00","close_reason":"All 69 public PROC2 functions implemented plus 4 internal functions. Module complete."}
{"id":"source-mst","title":"SMD_$ subsystem analysis and implementation","description":"# SMD_$ Subsystem Analysis and Implementation\n\n## Overview\nSMD = Screen Management Display - manages display hardware, cursors, fonts, and screen operations for Domain/OS.\n\n## Analysis Complete\n- **75+ functions identified** in the SMD_$ namespace\n- **Key data structures mapped**:\n  - `smd_globals_t` at 0x00E82B8C - global state including ASID-to-unit mapping, blanking state\n  - `smd_display_unit_t` at 0x00E2E3FC - per-display unit state (0x10C bytes each)\n  - `smd_display_hw_t` - hardware info pointed from unit (display type, dimensions, lock state, etc.)\n  - `smd_display_info_t` at 0x00E27376 - display configuration (0x60 bytes each)\n\n## Files Created\n- `smd/smd.h` - Public API (50+ function prototypes)\n- `smd/smd_internal.h` - Internal structures and helpers\n- `smd/smd_data.c` - Global variable definitions\n- `smd/cold_init.c` - SMD_$COLD_INIT (no-op stub)\n- `smd/unblank.c` - SMD_$UNBLANK implementation\n- `smd/inq_disp_type.c` - SMD_$INQ_DISP_TYPE implementation\n- `smd/inq_disp_info.c` - SMD_$INQ_DISP_INFO implementation\n- `smd/video_ctl.c` - SMD_$VIDEO_CTL implementation\n- `smd/assoc.c` - SMD_$ASSOC implementation\n- `smd/sau2/lock_display.s` - SMD_$LOCK_DISPLAY assembly (uses SR manipulation)\n- `tpad/tpad.h` - Stub header for trackpad subsystem\n\n## Build Status\n- Makefile updated to include smd/*.c and smd/sau2/*.s\n- Build blocked by pre-existing issues in ast/allocate_aste.c (CRASH_SYSTEM signature mismatch)\n- Once ast issue fixed, SMD files should compile\n\n## Key Functions Analyzed\n- SMD_$INIT (0x00E34D2C) - Main initialization, has jump table complexity\n- SMD_$ASSOC (0x00E6D882) - Associates display with process ASID\n- SMD_$INQ_DISP_INFO (0x00E70124) - Returns display type, dimensions, bit depth\n- SMD_$VIDEO_CTL (0x00E6F838) - Enable/disable video output\n- SMD_$UNBLANK (0x00E6EFB4) - Restore blanked display\n- SMD_$LOCK_DISPLAY (0x00E15CCE) - Low-level lock with interrupt disable\n\n## Display Types Identified\n- 1, 2: Mono landscape/portrait (1024x800 / 800x1024)\n- 3, 4: Color 1024x2048\n- 5, 9: Hi-res 2048x1024\n- 6, 8, 10, 11: Mono 1024x1024 variants\n\n## Remaining Work\n- Fix pre-existing build issues in ast/ subsystem\n- Implement remaining SMD functions (BLT, scroll, cursor, font, tracking)\n- Add unit tests for non-hardware-dependent functions\n- Complete SMD_$INIT (complex jump table decompilation)\n\n## Dependencies\n- ec/ec.h - Event counts for synchronization\n- proc1/proc1.h - PROC1_$AS_ID for current process\n- time/time.h - TIME_$CLOCKH for blanking timestamps\n- term/term.h - TERM_$SET_REAL_LINE_DISCIPLINE\n- tpad/tpad.h - TPAD_$SET_UNIT (stub created)","status":"in_progress","priority":2,"issue_type":"epic","created_at":"2026-01-14T20:06:53.699248-08:00","created_by":"toshok","updated_at":"2026-01-14T20:20:47.236884-08:00"}
{"id":"source-non","title":"MST_$TOUCH - page fault handling","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T20:38:43.419711-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:43.419711-08:00"}
{"id":"source-qna","title":"MST_$UNMAP_PRIVI - internal unmap function","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T20:38:43.504826-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:43.504826-08:00"}
{"id":"source-r1l","title":"Revisit CPU architecture vs SAU vs feature-level code organization","description":"The current code organization uses SAU (System Architecture Unit) numbers for platform-specific code splits (e.g., ec/sau2/advance.s). However, this conflates several different concerns:\n\n1. **CPU architecture** (m68k vs x86 vs ARM) - instruction set, calling conventions, register usage\n2. **SAU variants** (sau1, sau2, etc.) - Apollo-specific hardware configurations\n3. **Feature-level differences** - e.g., MMU type, peripheral support\n\nThe ec/sau2/*.s files contain m68k assembly for SR (Status Register) manipulation to disable/enable interrupts. This is fundamentally a CPU architecture concern, not an SAU-level concern - the same code would work on any m68k-based SAU.\n\nConsider reorganizing to something like:\n- `ec/arch/m68k/` for m68k-specific assembly\n- `ec/arch/x86/` for x86 equivalents (when porting)\n- Keep SAU-level splits only for actual hardware variant differences\n\nThis would make the retargetability goal clearer and avoid confusion about what each directory level represents.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-13T11:18:14.179673-08:00","created_by":"toshok","updated_at":"2026-01-13T11:18:14.179673-08:00"}
{"id":"source-suh","title":"Fix FUN_ #defines in AST subsystem","description":"Fix #define FUN_ patterns in ast_internal.h by renaming functions in Ghidra.\n\nFor each function:\n1. Rename in Ghidra: gsk rename \u003cADDRESS\u003e '\u003cNAME\u003e'\n2. Update parameter names/types as needed\n3. Remove the #define from ast_internal.h\n4. Add proper function prototype\n\nFunctions to fix (21 total):\n- FUN_00e0209e → ast_$lookup_aote_by_uid\n- FUN_00e020fa → ast_$force_activate_segment\n- FUN_00e0250c → ast_$lookup_aste\n- FUN_00e0255c → ast_$lookup_or_create_aste\n- FUN_00e00c08 → ast_$wait_for_page_transition\n- FUN_00e00d46 → ast_$allocate_pages\n- FUN_00e0283c → ast_$clear_transition_bits\n- FUN_00e02898 → ast_$setup_page_read\n- FUN_00e0305c → ast_$count_valid_pages\n- FUN_00e02af6 → ast_$read_area_pages\n- FUN_00e02ca6 → ast_$read_area_pages_network\n- FUN_00e01ad2 → ast_$process_aote\n- FUN_00e00f7c → ast_$release_aote\n- FUN_00e01d66 → ast_$allocate_aote\n- FUN_00e013a0 → ast_$purify_aote\n- FUN_00e01566 → ast_$update_aste\n- FUN_00e062fa → ast_$invalidate_with_wait\n- FUN_00e064b0 → ast_$invalidate_no_wait\n- FUN_00e03fbc → ast_$flush_installed_pages\n- FUN_00e05214 → ast_$set_attribute_internal\n- FUN_00e00be8 → ast_$validate_uid","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-14T20:24:54.713447-08:00","created_by":"toshok","updated_at":"2026-01-14T20:25:48.996498-08:00"}
{"id":"source-vgl","title":"MST remaining map variants (MAP_AT, MAPS, etc)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-13T20:38:50.014741-08:00","created_by":"toshok","updated_at":"2026-01-13T20:38:50.014741-08:00"}
